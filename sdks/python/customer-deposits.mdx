---
title: "Customer Deposits"
description: "Learn how to generate checkout links for customer deposits"
icon: "piggy-bank"
---

Generate checkout links that allow customers to deposit funds directly into your AI Agent's wallet. When customers complete the payment process, the funds will be immediately available for your agent to use.

## Creating a Deposit Link

Generate a checkout URL where customers can complete their deposit:

```python
deposit_link = payman.payments.initiate_deposit(
    amount_decimal=100.00,
    memo="Wallet deposit",
    metadata={
        "customer_id": "cust_123",
        "customer_email": "customer@example.com"
    }
)

# Redirect customer to the checkout URL
print("Checkout URL:", deposit_link.checkout_url)
```

## Parameters

### Required Parameters

| Parameter        | Type  | Description                                   |
| ---------------- | ----- | --------------------------------------------- |
| `amount_decimal` | float | The deposit amount (e.g., 100.00 for $100.00) |

### Optional Parameters

| Parameter   | Type | Description                                              |
| ----------- | ---- | -------------------------------------------------------- |
| `wallet_id` | str  | Target wallet ID (if agent has multiple wallets)         |
| `memo`      | str  | Note for the transaction (visible to customers)          |
| `fee_mode`  | str  | How to handle processing fees (see Fee Handling section) |
| `metadata`  | dict | Additional key-value data for tracking purposes          |

## Fee Handling Options

Control how payment processing fees are handled using the `fee_mode` parameter:

```python
# Fees are deducted from the deposit amount (default)
included_fees = payman.payments.initiate_deposit(
    amount_decimal=100.00,
    fee_mode="INCLUDED_IN_AMOUNT"  # Customer pays exactly $100.00, agent receives less
)

# Fees are added on top of the deposit amount
added_fees = payman.payments.initiate_deposit(
    amount_decimal=100.00,
    fee_mode="ADD_TO_AMOUNT"  # Customer pays more than $100.00, agent receives full $100.00
)
```

## Response Object

The API returns an object containing the checkout URL:

```python
{
    "checkout_url": str,  # URL where customer completes the deposit
    "expires_at": str,    # ISO timestamp when the link expires
    "id": str             # Unique ID for this deposit link
}
```

## Using Metadata for Customer Information

Since customer details are no longer required parameters, you can include them in the metadata dictionary:

```python
deposit_link = payman.payments.initiate_deposit(
    amount_decimal=50.00,
    memo="Premium subscription",
    metadata={
        "customer_id": "cust_456",
        "customer_email": "customer@example.com",
        "customer_name": "Jane Smith",
        "order_id": "order_789",
        "subscription_tier": "premium",
        "source": "web_checkout"
    }
)
```

## Error Handling

Implement proper error handling to manage API exceptions:

```python
from paymanai.errors import PaymanError

try:
    deposit_link = payman.payments.initiate_deposit(
        amount_decimal=100.00,
        memo="Account funding"
    )

    # Success - redirect customer to the checkout URL
    redirect_to_checkout(deposit_link.checkout_url)

except PaymanError as error:
    if error.code == "invalid_amount":
        print("Invalid deposit amount specified")
    elif error.code == "wallet_not_found":
        print("Specified wallet not found")
    elif error.code == "insufficient_permissions":
        print("Agent lacks permission to create deposit links")
    else:
        print("Failed to create deposit link:", error.message)
```

<Note>
	**Important:** The generated checkout URL is valid for 24 hours. After
	expiration, you'll need to create a new deposit link. Each link can only be
	used once, regardless of whether a payment was completed.
</Note>

## Using Type Hints

For better code safety and IDE support:

```python
from paymanai.types import DepositLinkResponse
from typing import Dict, Any, Optional

def create_deposit_link(
    amount: float,
    memo: Optional[str] = None,
    customer_info: Optional[Dict[str, Any]] = None
) -> DepositLinkResponse:
    """
    Create a deposit link for a customer.

    Args:
        amount: The amount to deposit in decimal format
        memo: Optional note for the transaction
        customer_info: Optional dictionary of customer information

    Returns:
        Response object containing the checkout URL and metadata
    """
    metadata = customer_info or {}

    return payman.payments.initiate_deposit(
        amount_decimal=amount,
        memo=memo,
        metadata=metadata
    )

# Example usage
deposit = create_deposit_link(
    amount=75.50,
    memo="Monthly subscription",
    customer_info={"customer_id": "cust_789", "email": "user@example.com"}
)
```
