---
title: "Search Payees"
description: "Learn how to search for existing payment destinations"
icon: "magnifying-glass"
---

Payman provides flexible search capabilities to help you find and manage your AI Agent's payment destinations. You can search by name, contact details, account information, and other criteria.

## Basic Usage

### Retrieve All Destinations

To get a list of all payment destinations associated with your agent:

```python
all_destinations = payman.payments.search_payees()
print(f"Found {len(all_destinations)} payment destinations")
```

### Search with Specific Filters

Use filters to narrow down your search results:

```python
filtered_destinations = payman.payments.search_payees(
    name="John",                    # Partial name match
    contact_email="john@example.com",
    type="US_ACH"
)
```

## Available Search Filters

| Filter                 | Type      | Description                                                                |
| ---------------------- | --------- | -------------------------------------------------------------------------- |
| `name`                 | str       | Search by destination name (partial match)                                 |
| `contact_email`        | str       | Search by contact email address                                            |
| `contact_phone_number` | str       | Search by contact phone number                                             |
| `contact_tax_id`       | str       | Search by tax identification number                                        |
| `account_number`       | str       | Search by last 4 digits of bank account number                             |
| `routing_number`       | str       | Search by bank routing number                                              |
| `type`                 | str       | Filter by destination type (`US_ACH`, `CRYPTO_ADDRESS`, or `PAYMAN_AGENT`) |
| `customer_id`          | str       | Filter by your system's customer ID                                        |
| `status`               | str       | Filter by status (`ACTIVE`, `ARCHIVED`, or `DELETED`)                      |
| `tags`                 | list[str] | Filter by tags (list of tag strings)                                       |

## Search Examples

### Search by Destination Type

Find destinations of a specific type:

```python
# Find all ACH bank account destinations
ach_destinations = payman.payments.search_payees(
    type="US_ACH"
)

# Find all cryptocurrency wallet destinations
crypto_destinations = payman.payments.search_payees(
    type="CRYPTO_ADDRESS"
)

# Find all Payman agent destinations
agent_destinations = payman.payments.search_payees(
    type="PAYMAN_AGENT"
)
```

### Search by Contact Information

Search for destinations using contact details:

```python
# Search by email
email_search = payman.payments.search_payees(
    contact_email="finance@company.com"
)

# Search by phone number
phone_search = payman.payments.search_payees(
    contact_phone_number="+1234567890"
)

# Combined search
contact_search = payman.payments.search_payees(
    contact_email="support@company.com",
    contact_phone_number="+1234567890"
)
```

### Search by Tags

Filter destinations by tags:

```python
# Find destinations tagged as 'vendor'
vendor_destinations = payman.payments.search_payees(
    tags=["vendor"]
)

# Find destinations with multiple tags
tagged_destinations = payman.payments.search_payees(
    tags=["primary", "monthly"]
)
```

## Response Structure

The search method returns a list of payment destination objects:

```python
[
    {
        "id": "dest_123abc",          # Unique identifier
        "name": "John Doe",           # Display name
        "type": "US_ACH",             # Destination type
        "organization_id": "org_xyz", # Your organization ID
        "status": "ACTIVE",           # Current status
        "contact_details": {
            "contact_type": "individual",
            "email": "john@example.com",
            "phone_number": "+1234567890",
            "address": "123 Main St",
            "tax_id": "***-**-6789"   # Partially masked for security
        },
        "tags": ["primary", "vendor"],
        "created_at": "2024-01-22T10:00:00Z",
        "updated_at": "2024-01-22T10:00:00Z"
    },
    # Additional destinations...
]
```

## Error Handling

Implement proper error handling to manage issues that may arise during searches:

```python
from paymanai.errors import PaymanError

try:
    destinations = payman.payments.search_payees(
        name="John",
        type="US_ACH"
    )

    print(f"Found {len(destinations)} matching destinations")

except PaymanError as error:
    if error.code == "invalid_parameter":
        print("Invalid search parameter provided")
    elif error.code == "rate_limit_exceeded":
        print("Too many search requests. Please try again later.")
    else:
        print("Search operation failed:", error.message)
```

<Note>
	**Security Note:** For your protection, sensitive information such as
	account numbers, tax IDs, and other personal identifiers are partially
	masked in search results. Only the last 4 digits of account numbers and
	similar sensitive data are visible.
</Note>

## Advanced Usage

### Pagination and Sorting

For applications with many payment destinations, you can use pagination:

```python
# Get destinations with pagination
paginated_results = payman.payments.search_payees(
    limit=10,       # Number of results per page
    offset=20,      # Skip the first 20 results
    sort_by="name", # Sort by name
    sort_order="asc" # Ascending order
)
```

| Parameter    | Type | Description                                                 |
| ------------ | ---- | ----------------------------------------------------------- |
| `limit`      | int  | Maximum number of results to return (default: 50, max: 100) |
| `offset`     | int  | Number of results to skip (for pagination)                  |
| `sort_by`    | str  | Field to sort by (`name`, `created_at`, `type`, etc.)       |
| `sort_order` | str  | Sort direction (`asc` or `desc`)                            |

### Using Type Hints

For better code safety and IDE support:

```python
from paymanai.types import PaymentDestination
from typing import List, Optional

def find_destinations(
    name_prefix: Optional[str] = None,
    destination_type: Optional[str] = None,
    is_active: bool = True
) -> List[PaymentDestination]:
    """
    Search for payment destinations with specific criteria.

    Args:
        name_prefix: Optional prefix to search by name
        destination_type: Optional filter by type (US_ACH, CRYPTO_ADDRESS, etc.)
        is_active: Whether to return only active destinations

    Returns:
        List of matching payment destinations
    """
    status = "ACTIVE" if is_active else None

    return payman.payments.search_payees(
        name=name_prefix,
        type=destination_type,
        status=status
    )

# Example usage
active_vendors = find_destinations(name_prefix="Vendor", is_active=True)
```
